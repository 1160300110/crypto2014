\input{main.tex}

\title{Public-Key Encryption and RSA Encryption}

\begin{document}
\maketitle
\begin{frame}
\frametitle{Outline}
\tableofcontents
\end{frame}
\section{Definitions and Securities of Public-Key Encryption}
\begin{frame}\frametitle{Definitions}
\begin{figure}
\begin{center}
\input{tikz/public-key}
\end{center}
\end{figure}
\begin{itemize}
\item \textbf{Key-generation} algorithm: $(pk,sk) \gets \mathsf{Gen}$, key length $\ge n$.
\item  \textbf{Plaintext space} $\mathcal{M}$ is associated with $pk$.
\item \textbf{Encryption} algorithm: $c \gets \mathsf{Enc}_{pk}(m)$.
\item \textbf{Decryption} algorithm: $m:= \mathsf{Dec}_{sk}(c)$, or outputs $\perp$.
\item \textbf{Requirement}: $\Pr[\mathsf{Dec}_{sk}(\mathsf{Enc}_{pk}(m)) = m] \ge 1 - \mathsf{negl}(n)$.
\end{itemize}
\end{frame}
\begin{frame}\frametitle{Security against Eavesdroppers $=$ CPA}
The eavesdropping indistinguishability experiment $\mathsf{PubK}^{\mathsf{eav}}_{\mathcal{A},\Pi}(n)$:
\begin{enumerate}
\item $(pk,sk) \gets \mathsf{Gen}(1^n)$.
\item $\mathcal{A}$ \textbf{is given input $\mathbf{pk}$ and so oracle access to $\mathbf{\mathsf{Enc}_{pk}(\cdot)}$}, outputs $m_0, m_1$ of the same length. 
\item $b \gets \{0,1\}$. $c \gets \mathsf{Enc}_{pk}(m_b)$ (challenge) is given to $\mathcal{A}$.
\item $\mathcal{A}$ \textbf{continues to have access to $\mathbf{\mathsf{Enc}_{pk}(\cdot)}$} and outputs $b'$.
\item If $b' = b$, $\mathcal{A}$ succeeded $\mathsf{PrivK}^{\mathsf{eav}}_{\mathcal{A},\Pi}=1$, otherwise 0.
\end{enumerate}
\begin{definition}
$\Pi$ is \textbf{CPA-secure} if $\forall$ \textsc{ppt} $\mathcal{A}$, $\exists$ $\mathsf{negl}$ such that
\[ \Pr\left[\mathsf{PubK}^{\mathsf{cpa}}_{\mathcal{A},\Pi}(n)=1\right] \le \frac{1}{2} + \mathsf{negl}(n). \]
\end{definition}
\end{frame}
\begin{frame}\frametitle{Security Properties of Public-Key Encryption}
\begin{theorem}
No deterministic public-key encryption scheme is secure in the presence of an eavesdropper. 
\end{theorem}
\begin{proposition}
If $\Pi$ is secure in the presence of an eavesdropper, then $\Pi$ also is CPA-secure.
\end{proposition}
\begin{theorem}
If $\Pi$ is secure in the presence of an eavesdropper, then $\Pi$ is secure for multiple encryptions.
\end{theorem}
\begin{proposition}
\alert{Perfectly-secret public-key encryption is impossible.}
\end{proposition}
\end{frame}

\begin{comment}
\begin{frame}\frametitle{Definition of Security of Multiple Encryptions}
The multiple message eavesdropping experiment $\mathsf{PubK}^{\mathsf{mult}}_{\mathcal{A},\Pi}(n)$:
\begin{enumerate}
\item $(pk,sk) \gets \mathsf{Gen}(1^n)$.
\item $\mathcal{A}$ is given input $pk$, outputs $\vec{M}_0=(m_0^1,\dots,m_0^t)$, $\vec{M}_1=(m_1^1,\dots,m_1^t)$ with $\forall i, |m_0^i| = |m_1^i|$. 
\item $b \gets \{0,1\}$. $c^i \gets \mathsf{Enc}_{pk}(m_b^i)$ and $\vec{C}=(c^1,\dots,c^t)$ is given to $\mathcal{A}$. $\mathcal{A}$ outputs $b'$.
\item If $b' = b$, $\mathcal{A}$ succeeded $\mathsf{PrivK}^{\mathsf{mult}}_{\mathcal{A},\Pi}=1$, otherwise 0.
\end{enumerate}
\begin{definition}
$\Pi$ has \textbf{indistinguishable multiple encryption in the presence of an eavesdropper} if $\forall$ \textsc{ppt} $\mathcal{A}$, $\exists$ $\mathsf{negl}$ such that
\[ \Pr\left[\mathsf{PubK}^{\mathsf{mult}}_{\mathcal{A},\Pi}(n)=1\right] \le \frac{1}{2} + \mathsf{negl}(n). \]
\end{definition}
\end{frame}
\begin{frame}\frametitle{Security of Two Encryptions}
Prove: for two encryptions, $\Pr[\mathsf{PubK}^{\mathsf{mult}}_{\mathcal{A},\Pi}(n)=1] \le \frac{1}{2} + \mathsf{negl}(n)$.\\ Let $c_i^j = \mathsf{Enc}_{pk}(m_i^j)$.
\begin{align*}
\Pr[\mathsf{PubK}^{\mathsf{mult}}_{\mathcal{A},\Pi}(n)=1] &= \frac{1}{2}\cdot \Pr[\mathcal{A}(\alert{c^1_0},\alert{c^2_0})=\alert{0}] + \frac{1}{2}\cdot \Pr[\mathcal{A}(c^1_1,c^2_1)=1]
\end{align*}
Reduce $\mathcal{A}'$ for a single message to $\mathcal{A}$ for two messages.
\begin{figure}
\begin{center}
\input{tikz/hybrideg}
\end{center}
\end{figure}
\end{frame}
\begin{frame}\frametitle{Proof (Cont.)}
\[\text{Prove}:\;\frac{1}{2}+\mathsf{negl}(n) \ge \frac{1}{2}\cdot \Pr[\mathcal{A}(\alert{c_0^1},\alert{c_0^2})=\alert{0}] + \frac{1}{2}\cdot \Pr[\mathcal{A}(\alert{c_0^1},c_1^2)=1].\]
$\Pr[\mathcal{A}'(\alert{c^2_0})=\alert{0}]=\Pr[\mathcal{A}(\alert{c^1_0},\alert{c^2_0})=\alert{0}]$;
$\Pr[\mathcal{A}'(c^2_1)=1]=\Pr[\mathcal{A}(\alert{c^1_0},c^2_1)=1]$.\\
\begin{align*}
\frac{1}{2}+\mathsf{negl}(n) &\ge \Pr[\mathsf{PubK}^{\mathsf{eav}}_{\mathcal{A'},\Pi}(n)=1] \\
&= \frac{1}{2}\cdot \Pr[\mathcal{A}'(\alert{c^2_0})=\alert{0}] + \frac{1}{2}\cdot \Pr[\mathcal{A}'(c^2_1)=1]\\
&= \frac{1}{2}\cdot \Pr[\mathcal{A}(\alert{c^1_0},\alert{c^2_0})=\alert{0}] + \frac{1}{2}\cdot \Pr[\mathcal{A}(\alert{c^1_0},c^2_1)=1].
\end{align*}
\[\text{Similarly, }\;\frac{1}{2}+\mathsf{negl}(n) \ge \frac{1}{2}\cdot \Pr[\mathcal{A}(\alert{c_0^1},c_1^2)=\alert{0}] + \frac{1}{2}\cdot \Pr[\mathcal{A}(c_1^1,c_1^2)=1].\]
\end{frame}
\begin{frame}\frametitle{Proof (Cont.)}
\begin{align*}
1+\mathsf{negl}(n) &\ge \frac{1}{2}\cdot \Pr[\mathcal{A}(\alert{c_0^1},\alert{c_0^2})=\alert{0}] + \frac{1}{2}\cdot \Pr[\mathcal{A}(c_1^1,c_1^2)=1]\\
&+ \frac{1}{2}\cdot \left(\Pr[\mathcal{A}(\alert{c_0^1},c_1^2)=1] +  \Pr[\mathcal{A}(\alert{c_0^1},c_1^2)=\alert{0}]\right)\\
&= \frac{1}{2} + \Pr[\mathsf{PubK}^{\mathsf{mult}}_{\mathcal{A},\Pi}(n)=1]. 
\end{align*}
\end{frame}
\begin{frame}\frametitle{Hybrid Argument}
Proof technique to show that two distributions are computationally indistinguishable.
\begin{enumerate}
\item Define a sequence of polynomially many distributions $D_1,\dotsc,D_t$ (hybrid distributions) as follows:
\begin{itemize}
\item $D_1$ and $D_t$ are to be shown computationally indistinguishable.
\item Any adjacent distributions $D_i$ and $D_{i+1}$ differ by only one application of a cryptographic primitive.
\end{itemize}
\item It is (comparatively) easier to prove that adjacent distributions are computationally indistinguishable.
\item Since computational indistinguishability is transitive across a polynomial number of distributions, we conclude that $D_1$ and $D_t$ are computationally indistinguishable.
\end{enumerate}
\end{frame}
\begin{frame}\frametitle{Security of Multiple Encryptions}
Step 1: define a sequence of distribution:
\[ \vec{C}^{(i)} \overset{\text{def}}{=} \underbrace{c^1_0,\dotsc,c^i_0}_{i\; \text{terms}},\underbrace{c^{i+1}_1,\dotsc,c^t_1}_{t-i\; \text{terms}}.\]
\[
\Pr[\mathsf{PubK}^{\mathsf{mult}}_{\mathcal{A},\Pi}(n)=1] = \frac{1}{2}\cdot \Pr[\mathcal{A}(\vec{C}^{(t)})=0] + \frac{1}{2}\cdot \Pr[\mathcal{A}(\vec{C}^{(0)})=1]
\]
\end{frame}
\begin{frame}\frametitle{Proof (Cont.)}
Step 2: prove that adjacent distributions are indistinguishable.\\ Reduce $\mathcal{A}'$ for single message to $\mathcal{A}$.
\begin{figure}
\begin{center}
\input{tikz/hybridproof}
\end{center}
\end{figure}
If $\mathcal{A}$ distinguishes between $\vec{C}^{(i)}$ and $\vec{C}^{(i-1)}$, this means that it distinguishes between $c^i_0$ and $c^i_1$ (this is the only difference).
\end{frame}
\begin{frame}\frametitle{Proof (Cont.)}
\begin{align*}
\Pr[\mathcal{A'}=0|b=0] &= \sum^t_{i^*=1}\frac{1}{t}\cdot \Pr[\mathcal{A}(\vec{C}^{(i^*)})=0].\\
\Pr[\mathcal{A'}=1|b=1] &= \sum^t_{i^*=1}\frac{1}{t}\cdot \Pr[\mathcal{A}(\vec{C}^{(i^*-1)})=1]\\
&=\sum^{t-1}_{i^*=0}\frac{1}{t}\cdot \Pr[\mathcal{A}(\vec{C}^{(i^*)})=1].
\end{align*}
\end{frame}
\begin{frame}\frametitle{Proof (Cont.)}
Step 3: conclusion.
\begin{align*}
\frac{1}{2}+\mathsf{negl}(n) &\ge \Pr[\mathsf{PubK}^{\mathsf{eav}}_{\mathcal{A'},\Pi}(n)=1] \\
&= \frac{1}{2}\cdot \Pr[\mathcal{A'}=0|b=0] + \frac{1}{2}\cdot \Pr[\mathcal{A'}=1|b=1]\\
&= \sum^t_{i^*=1}\frac{1}{2t}\cdot \Pr[\mathcal{A}(\vec{C}^{(i^*)})=0] + \sum^{t-1}_{i^*=0}\frac{1}{2t}\cdot \Pr[\mathcal{A}(\vec{C}^{(i^*)})=1]\\
&= \frac{1}{2t}\cdot \sum^{t-1}_{i^*=1}\left( \Pr[\mathcal{A}(\vec{C}^{(i^*)})=0] + \Pr[\mathcal{A}(\vec{C}^{(i^*)})=1]\right)\\
&+ \frac{1}{2t}\cdot \left( \Pr[\mathcal{A}(\vec{C}^{(t)})=0] + \Pr[\mathcal{A}(\vec{C}^{(0)})=1]\right)\\
&= \frac{t-1}{2t} + \frac{1}{t}\cdot \Pr[\mathsf{PubK}^{\mathsf{mult}}_{\mathcal{A},\Pi}(n)=1].
\end{align*}
\end{frame}
\begin{frame}\frametitle{Encrypting Arbitrary-Length Messages}
$\Pi = (\mathsf{Gen}, \mathsf{Enc}, \mathsf{Dec})$ is an encryption scheme encrypts only 1-bit message.\\
$\Pi'= (\mathsf{Gen}, \mathsf{Enc}', \mathsf{Dec}')$:
\[\mathsf{Enc}'_{pk}(m)=\mathsf{Enc}_{pk}(m_1),\dotsc,\mathsf{Enc}_{pk}(m_t).\]
\begin{proposition}
If $\Pi$ has indistinguishable encryptions in the presence of an eavesdropper, then so does $\Pi'$.
\end{proposition}
\end{frame}
\end{comment}

\begin{frame}\frametitle{Construction of Hybrid Encryption}
To speed up the encryption of long message, use private-key encryption $\Pi'$ in tandem with public-key encryption $\Pi$.
\begin{columns}
\begin{column}{5cm}
\begin{figure}
\begin{center}
\input{tikz/hybrid-encrypt}
\end{center}
\end{figure}
\end{column}
\begin{column}{5cm}
\begin{construction}
$\Pi^{\mathsf{hy}} = (\mathsf{Gen}^{\mathsf{hy}}, \mathsf{Enc}^{\mathsf{hy}}, \mathsf{Dec}^{\mathsf{hy}})$:
\begin{itemize}
\item $\mathsf{Gen}^{\mathsf{hy}}$: $(pk,sk) \gets \mathsf{Gen}(1^n)$.
\item $\mathsf{Enc}^{\mathsf{hy}}$: $pk$ and $m$. 
\begin{enumerate}
\item $k \gets \{0,1\}^n$.
\item $c_1 \gets \mathsf{Enc}_{pk}(k)$, $c_2 \gets \mathsf{Enc}'_{k}(m)$.
\end{enumerate}
\item $\mathsf{Dec}^{\mathsf{hy}}$: $sk$ and $\langle c_1,c_2\rangle$.
\begin{enumerate}
\item $k := \mathsf{Dec}_{sk}(c_1)$.
\item $m := \mathsf{Dec}'_k(c_2)$.
\end{enumerate}
\end{itemize}
\end{construction}
\end{column}
\end{columns}
Hybrid encryption is a public-key encryption without any secret key in advance.
\end{frame}
\begin{frame}\frametitle{Security of Hybrid Encryption}
\begin{theorem}
If $\Pi$ is a CPA-secure public-key encryption scheme and $\Pi'$ is a private-key encryption scheme that has indistinguishable encryptions in the presence of an eavesdropper, then $\Pi^{\mathsf{hy}}$ is a CPA-secure public-key encryption scheme.
\end{theorem}
\begin{figure}
\begin{center}
\input{tikz/hybrid-enc-proof}
\end{center}
\end{figure}
\end{frame}
\section{Security Against Chosen-Ciphertext Attacks}
\begin{frame}\frametitle{Scenarios of CCA in Public-Key Setting}
\begin{enumerate}
\item An adversary $\mathcal{A}$ observes the ciphertext $c$ sent by $\mathcal{S}$ to $\mathcal{R}$.
\item $\mathcal{A}$ send $c'$ to $\mathcal{R}$ in the name of $\mathcal{S}$ or its own.
\item $\mathcal{A}$ infer $m$ from the decryption of $c'$ to $m'$.
\end{enumerate}
\begin{exampleblock}{Scenarios}
\begin{itemize}
\item \textbf{login to on-line bank with the password}: trial-and-error, learn info from the feedback of bank.
\item \textbf{reply an e-mail with the quotation of decrypted text}.
\item \textbf{malleability of ciphertexts}: e.g. doubling others' bids at an auction.
\end{itemize}
\end{exampleblock}
\end{frame}
\begin{frame}\frametitle{Definition of Security Against CCA/CCA2}
The CCA/CCA2 indistinguishability experiment $\mathsf{PubK}^{\mathsf{cca}}_{\mathcal{A},\Pi}(n)$:
\begin{enumerate}
\item $(pk,sk) \gets \mathsf{Gen}(1^n)$.
\item $\mathcal{A}$ \textbf{is given input $pk$ and oracle access to $\mathsf{Dec}_{sk}(\cdot)$}, outputs $m_0, m_1$ of the same length. 
\item $b \gets \{0,1\}$. $c \gets \mathsf{Enc}_{pk}(m_b)$ is given to $\mathcal{A}$.
\item $\mathcal{A}$ \textbf{have access to $\mathsf{Dec}_{sk}(\cdot)$ except for $c$ in CCA2}\footnote{CCA is also called Lunchtime attacks; CCA2 is also called Adaptive CCA.} and outputs $b'$.
\item If $b' = b$, $\mathcal{A}$ succeeded $\mathsf{PrivK}^{\mathsf{cca}}_{\mathcal{A},\Pi}=1$, otherwise 0.
\end{enumerate}
\begin{definition}
$\Pi$ has \textbf{CCA/CCA2-secure} if $\forall$ \textsc{ppt} $\mathcal{A}$, $\exists$ $\mathsf{negl}$ such that
\[ \Pr\left[\mathsf{PubK}^{\mathsf{cca}}_{\mathcal{A},\Pi}(n)=1\right] \le \frac{1}{2} + \mathsf{negl}(n). \]
\end{definition}
\end{frame}
\begin{frame}{State of the Art on CCA2-secure Encryption}
\begin{itemize}
\item \textbf{Zero-Knowledge Proof}: complex, and impractical. (e.g., Dolev-Dwork-Naor)
\item \textbf{Random Oracle} model: efficient, but not realistic (to consider CRHF as RO). (e.g., RSA-OAEP and Fujisaki-Okamoto)
\item \textbf{DDH(Decisional Diffie-Hellman assumption) and UOWHF(Universal One-Way Hashs Function)}: x2 expansion in size, but security proved w/o RO or ZKP (e.g., Cramer-Shoup system).
\end{itemize}
\textbf{CCA2-secure implies Plaintext-aware}: an adversary cannot produce a valid ciphertext without ``knowing'' the plaintext.
\begin{block}{Open problem}
Constructing a CCA2-secure scheme based on RSA problem as efficient as ``Textbook RSA''.
\end{block}
\end{frame}
\begin{frame}\frametitle{Private Key Encryption vs. Public Key Encryption}
\begin{center}
\begin{tabular}{|c|c|c|} \hline
   & \textbf{Private Key} & \textbf{Public Key}             \\ \hline
\textbf{Secret Key}               & both parties & receiver \\ \hline
\textbf{Weakest Attack}           & Eav          & CPA      \\ \hline
\textbf{Probabilistic}            & CPA/CCA      & always   \\ \hline
\textbf{Assumption against CPA}   & OWF          & TDP      \\ \hline
\textbf{Assumption against CCA}   & OWF          & TDP$+$RO   \\ \hline
\textbf{Efficiency}               & fast         & slow     \\ \hline
\end{tabular}	
\end{center}
\end{frame}
\section{RSA Assumption}
\begin{frame}\frametitle{The RSA Problem}
\begin{block}{Recall group exponentiation on $\mathbb{Z}^*_N$}
Define function $f_e\;:$ $\mathbb{Z}^*_N \to \mathbb{Z}^*_N$ by $f_e(x) =[x^e \bmod N]$. \\ If $\gcd(e,\phi(N))=1$, then $f_e$ is a permutation. \\
If $d = [e^{-1} \bmod \phi(N)]$, then $f_d$ is the inverse of $f_e$.\\
\textbf{$e$'th root of $c$}: $g^e = c$, $g = c^{1/e} = c^{d}$. 
\end{block}
\textbf{Idea}: factoring is hard\\ $\implies$ for $N=pq$, finding $p,q$ is hard\\ $\implies$ computing $\phi(N)=(p-1)(q-1)$ is hard\\ $\implies$ computations modulo $\phi(N)$ is not available\\ 
\alert{\textbf{There is a gap.}}\\
$\implies$ \textbf{RSA problem} [Rivest, Shamir, and Adleman] is hard:\\
Given $y \in \mathbb{Z}^*_N$, compute $y^{-e}$, $e^{\text{th}}$-root of $y$ modulo $N$.
\begin{alertblock}{Open problem}
RSA problem is easier than factoring?
\end{alertblock}
\end{frame}
\begin{frame}\frametitle{Generating RSA Problem}
\begin{algorithm}[H]
\SetKwInOut{Input}{input}
\SetKwInOut{Output}{output}
\SetKw{KwF}{find}
\SetKw{KwC}{compute}
\DontPrintSemicolon
\caption{$\mathsf{GenRSA}$}
\Input{Security parameter $1^n$}
\Output{$N,e,d$}
\BlankLine
$(N,p,q) \gets \mathsf{GenModulus}(1^n)$\;
$\phi(N) := (p-1)(q-1)$\;
\KwF $e$ such that $\gcd(e,\phi(N))=1$\;
\KwC $d := [e^{-1} \bmod \phi(N)]$\;
\Return $N,e,d$\;
\end{algorithm}
\end{frame}
\begin{frame}\frametitle{The RSA Assumption}
The RSA experiment $\mathsf{RSAinv}_{\mathcal{A},\mathsf{GenRSA}}(n)$:
\begin{enumerate}
\item Run $\mathsf{GenRSA}(1^n)$ to obtain $(N,e,d)$.
\item Choose $y \gets \mathbb{Z}^*_N$.
\item $\mathcal{A}$ is given $N,e,y$, and outputs $x \in \mathbb{Z}^*_N$.
\item $\mathsf{RSAinv}_{\mathcal{A},\mathsf{GenRSA}}(n)=1$ if $x^e \equiv y \pmod N$, and 0 otherwise.
\end{enumerate}
\begin{definition}
\textbf{RSA problem is hard relative to} $\mathsf{GenRSA}$ if $\forall$ \textsc{ppt} algorithms $\mathcal{A}$, $\exists$ $\mathsf{negl}$ such that
\[ \Pr[\mathsf{RSAinv}_{\mathcal{A},\mathsf{GenRSA}}(n) = 1] \le \mathsf{negl}(n).\]
\end{definition}
\end{frame}
\section{``Textbook RSA'' Encryption}
\begin{frame}\frametitle{``Textbook RSA''}
\begin{construction}
\begin{itemize}
\item $\mathsf{Gen}$: on input $1^n$ run $\mathsf{GenRSA}(1^n)$ to obtain $N,e,d$. $pk = \langle N,e \rangle$ and $sk = \langle N,d \rangle$.
\item $\mathsf{Enc}$: on input $pk$ and $m \in \mathbb{Z}^*_N$, $c:= [m^e \bmod N]$.
\item $\mathsf{Dec}$: on input $sk$ and $m \in \mathbb{Z}^*_N$, $m:= [c^d \bmod N]$.
\end{itemize}
\end{construction}
\begin{alertblock}{Insecurity}
Since the ``textbook RSA'' is deterministic, it is insecure with respect to any of the definitions of security we have proposed. 
\end{alertblock}
\end{frame}
\begin{frame}\frametitle{RSA Implementation Issues}
\begin{itemize}
\item \textbf{Encoding binary strings as elements of} $\mathbb{Z}^*_N$: $\ell = \|N\|$. Any binary string $m$ of length $\ell - 1$ can be viewed as an element of $Z_N$. Although $m$ may not be in $Z_N^*$, RSA still works.
\item \textbf{Choice of} $e$: Either $e=3$ or a small $d$ are bad choices. \\
      Recommended value: $e=65537=2^{16}+1$
\item \textbf{Using the Chinese remainder theorem}: to speed up the decryption.\\
\[ [c^d \bmod N] \leftrightarrow ([c^d \bmod p],[c^d \bmod q]). \]
Assume that exponentiation modulo a $v$-bit integer takes $v^3$ operations. RSA decryption takes $(2n)^3=8n^3$, whereas using CRT takes $2n^3$. 
\end{itemize}
\end{frame}
\begin{frame}\frametitle{Example of ``Textbook RSA''}
\begin{exampleblock}{$N=253$, $p=11$, $q=23$, $e=3$, $d=147$, $\phi(N)=220$.}
$m=0111001=57$.\\
Encryption: $250 := [57^3 \bmod 253]$.\\
Decryption: $57 := [250^{147} \bmod 253]$.
\newline

Using CTR,
\[ [250^{[147 \bmod 10]} \bmod 11] = [8^7 \bmod 11] = 2\]
\[ [250^{[147 \bmod 22]} \bmod 23] = [20^{15} \bmod 23] = 11\]
$57 \leftrightarrow (2,11)$.
\end{exampleblock}
\end{frame}
\begin{frame}\frametitle{Attacks on ``Textbook RSA'' with a small $e$}
\textbf{Small $e$ and small $m$ make modular arithmetic useless.}
\begin{itemize}
\item If $e=3$ and $m < N^{1/3}$, then $c = m^3$ and $m=c^{1/3}$.
\item In the hybrid encryption, 1024-bit RSA with 128-bit DES.
\end{itemize}

\textbf{A general attack when small $e$ is used:}
\begin{itemize}
\item $e=3$, the same message $m$ is sent to 3 different parties.
\item $c_1= [ m^3 \bmod N_1]$, $c_2= [ m^3 \bmod N_2]$, $c_3= [ m^3 \bmod N_3]$.
\item $N_1,N_2,N_3$ are coprime, and $N^*=N_1N_2N_3$, $\exists$ unique $\hat{c} < N^*$:\\
$\hat{c} \equiv c_1 \pmod{N_1}$, $\hat{c} \equiv c_2 \pmod{N_2}$, $\hat{c} \equiv c_3 \pmod{N_3}$.
\item With CRT, $\hat{c} \equiv m^3 \pmod{N^*}$. Since $m^3 < N^*$, $m = \hat{c}^{1/3}$.
\end{itemize}
\end{frame}
\begin{comment}
\begin{frame}\frametitle{A Quadratic Improvement in Recovering $m$}
If $1 \le m < \mathcal{L} = 2^{\ell}$, there is an attack that recovers $m$  in time $\sqrt{\mathcal{L}}$.
\begin{algorithm}[H]
\SetKwInOut{Input}{input}
\SetKwInOut{Output}{output}
\SetKw{KwS}{set}
\SetKw{KwT}{sort}
\DontPrintSemicolon
\caption{An attack on textbook RSA encryption}
\Input{Public key $\langle N,e \rangle$; ciphertext $c$; parameter $\ell$}
\Output{$m < 2^{\ell}$ such that $m^e \equiv c \pmod N$}
\BlankLine

\KwS $T := 2^{\alpha \ell}$ \tcc*[f]{$\frac{1}{2} < \text{constant}\; \alpha <1$}\;
\lFor{$r=1$ \KwTo $T$}{$x_r := [c/r^e \bmod N]$}\;
\KwT the pairs $\{ (r,x_r)\}^T_{r=1}$ by $x_r$\;
\For{$s=1$ \KwTo $T$}{
\If{$[s^e \bmod N] \overset{?}{=} x_r$ for some $r$}{
 \Return $[r\cdot s \bmod N]$\;
}
}
\Return fail\;
\end{algorithm}
It can be shown that with good probability that $m=r\cdot s$:
\[ c \equiv m^e = (r\cdot s)^e = r^e\cdot s^e \pmod N \]
\end{frame}
\end{comment}
\begin{frame}\frametitle{Common Modulus Attacks}
\textbf{Common Modulus Attacks}: the same modulus $N$.
\newline

\textbf{Case I}: for multiple users with their own secret keys.\\
Each user can find $\phi(N)$ with his own $e,d$, then find others' $d$.
\newline

\textbf{Case II}: for the same message encrypted with two public keys.\\
Assume $\gcd(e_1,e_2)=1$, $c_1 \equiv m^{e_1}$ and $c_2 \equiv m^{e_2} \pmod N$. $\exists X,Y$ such that $Xe_1 + Ye_2 = 1$.
\[ c_1^X\cdot c_2^Y \equiv m^{Xe_1}m^{Ye_2} \equiv m^1 \pmod N.\]
\end{frame}
\begin{frame}\frametitle{CCA in ``Textbook RSA'' Encryption}
\begin{exampleblock}{Recovering the message with CCA}
$\mathcal{A}$ choose a random $r \gets \mathbb{Z}^*_N$ and compute $c' = [r^e\cdot c \bmod N]$, and get $m'$ with CCA. Then $m= [m'\cdot r^{-1}\bmod N]$.
\[ m'\cdot r^{-1} \equiv (c')^dr^{-1} \equiv (r^e\cdot m^e)^dr^{-1} \equiv r^{ed}m^{ed}r^{-1} \equiv rmr^{-1} \equiv m.\]	
\end{exampleblock}
\begin{exampleblock}{Doubling the bid at an auction}
The ciphertext of an bid is $c = [m^e \bmod N]$. $c'= [2^ec \bmod N]$.
\[(c')^d \equiv (2^em^e)^d \equiv 2^{ed}m^{ed}\equiv 2m.\]
\end{exampleblock}
\end{frame}
\section{RSA Encryption in Practice}
\begin{frame}\frametitle{Padded RSA}
\textbf{Idea}: add randomness to improve security.
\begin{construction}
Let $\ell$ be a function with $\ell(n) \le 2n-2$ for all $n$.
\begin{itemize}
\item $\mathsf{Gen}$: on input $1^n$, run $\mathsf{GenRSA}(1^n)$ to obtain $(N,e,d)$. Output $pk = \langle N,e \rangle$, and $sk = \langle N,d \rangle$.
\item $\mathsf{Enc}$: on input $m \in \{0,1\}^{\ell(n)}$, choose a random string $r \gets \{0,1\}^{\|N\| - \ell(n)-1}$. Output $c:=[(r\|m)^e \bmod N]$.
\item $\mathsf{Dec}$: compute $\hat{m} := [c^d \bmod N]$, and output the $\ell(n)$ low-order bits of $\hat{m}$.
\end{itemize}
\end{construction}
$\ell$ should neither be too large ($r$ is too short in theory) nor be too small ($m$ is too short in practice).
\begin{theorem}
If the RSA problem is hard relative to $\mathsf{GenRSA}$, then Construction with $\ell(n)=\mathcal{O}(\log n)$ is CPA-secure.
\end{theorem}
\end{frame}
\begin{comment}
\begin{frame}\frametitle{PKCS \#1 v1.5 (RSAES-PKCS1-v1\_5)}
\textbf{Public-Key Cryptography Standard (PKCS) \#1 version 1.5}:
\begin{itemize}
\item $N$ has $k$ bytes, $2^{8(k-1)} \le N < 2^{8k}$.
\item Message $m$ has $D (\le k-11)$ bytes.
\item Random pad $r$ has $(k-D-3)$ bytes without $\{0\}^8$.
\item The ciphertext:
\end{itemize}
\[[(\{0\}^8\|\{0\}^610\|r\|\{0\}^8\|m)^e \bmod N]\] 
\textbf{Security}: PKCS \#1 v1.5 is believed to be CPA-secure, although no proof based on the RSA assumption has ever been shown.
\end{frame}
\begin{frame}\frametitle{Attack on PKCS \#1 v1.5}
\textbf{PKCS \#1 v1.5 used in HTTPS}:\\
if the first 16 bits of message is not ``02'' which is standing for ``PKCK \#1'', then the web server returns error.\newline

\textbf{CCA to infer the message $m$ of ciphertext $c$}:
\begin{enumerate}
\item choose a string $r$, compute $c' \gets r^e\cdot c = (r\cdot \mathsf{PKCS1}(m))^e$.
\item send $c'$ to the web server. If the server does not return error, some bits of $m$ can be learned.
\item change $r$ and learn other bits of $m$.
\end{enumerate}

\textbf{HTTPS Defense} [RFC 5246]: if not ``02'', set the message as a random string.
\end{frame}
\end{comment}
\begin{frame}\frametitle{PKCK \#1 v2.1 (RSAES-OAEP)}
\textbf{Optimal Asymmetric Encryption Padding} (OAEP): encode $m$ of length $n/2$ as $\hat{m}$ of length $2n$. $G, H$ are \textbf{Random Oracles}.
\[ \hat{m}_1 := G(r)\oplus (m\| \{0\}^{n/2}), \hat{m} := \hat{m}_1 \| (r \oplus H(\hat{m}_1)).\]
\begin{figure}
\begin{center}
\input{tikz/OAEP}
\end{center}
\end{figure}
RSA-OAEP is CCA-secure in Random Oracle model. \footnote{It may not be secure when RO is instantiated.} [RFC 3447]
\end{frame}
\begin{frame}\frametitle{OAEP Improvements}
\begin{columns}
\begin{column}{5cm}
\begin{figure}
\begin{center}
\input{tikz/OAEP-plus}
\input{tikz/SAEP-plus}
\end{center}
\end{figure}
\end{column}
\begin{column}{5cm}
\textbf{OAEP+}: $\forall $ trap-door permutation F, F-OAEP+ is CCA-secure.\newline

\textbf{SAEP+}: RSA (e=3) is a trap-door permutation, RSA-SAEP+ is CCA-secure.\newline

$W, G, H$ are Random Oracles.
\end{column}
\end{columns}
\end{frame}
\begin{frame}\frametitle{Remarks on RSA in Practice}
\textbf{Key lengths} with comparable security :
\begin{center}
\begin{tabular}{|c|c|} \hline
Symmetric & RSA  \\ \hline
80 bits & 1024 bits   \\
128 bits & 3072 bits  \\
256 bits & 15360 bits \\ \hline
\end{tabular}	
\end{center}
\alert{\textbf{Implementation attacks}}:\\
\textbf{Timing attack}: 
The time it takes to compute $c^d$ can expose $d$.
\newline

\textbf{Power attack}:
The power consumption of a smartcard while it is computing $c^d$ can expose $d$.
\newline

\textbf{Key generation trouble} (in OpenSSL RSA key generation):\\
Same $p$ will be generated by multiple devices (due to poor entropy at startup), but different $q$ (due to additional randomness).\\
$N_1,N_2$ from different devices, $\gcd(N_1,N_2) = p$.\\
Experiment result: factor 0.4\% of public HTTPS keys.
\end{frame}
\begin{frame}\frametitle{Faults Attack on RSA}
\textbf{Faults attack}:
A computer error during $c^d\bmod N$ can expose $d$.\newline

Using CRT to speed up the decryption:
\[ [c^d \bmod N] \leftrightarrow ([m_p \equiv c^d \pmod p],[m_q \equiv c^d \pmod q]).\]
\textbf{Suppose error occurs when computing $m_q$, but no error in $m_p$.}\newline

Then output is $m'$ where $m' \equiv c^d \pmod p$, $m' \not \equiv c^d \pmod q$.\\
So $(m')^e \equiv c \pmod p$, $(m')^e \not \equiv c \pmod q$.\\
\[\gcd((m')^e-c, N)=p.\]

\textbf{A common defense}: check output. (but 10\% slowdown)
\end{frame}
\begin{frame}\frametitle{Summary}
\begin{itemize}
\item eavesdropper=CPA, CCA/CCA2 in public-key encryptions.
\item hybrid argument, multiple encryptions.
\item hybrid encryption, ``textbook RSA'', padded RSA, PKCS.
\item small $e$, common modulus attacks, CCA, faults attack.
\end{itemize}
\end{frame}
\end{document}